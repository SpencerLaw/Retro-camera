<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>作业消消乐 - 快乐完成作业！</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
</head>
<body>

    <!-- 1. 授权登录界面 -->
    <div id="auth-screen" class="screen active">
        <button class="global-back-btn" title="返回首页">🔙</button>
        <div class="auth-box">
            <h1>🎒 <span id="auth-title-text">作业消消乐</span></h1>
            <p class="subtitle" id="auth-subtitle-text">让每一次作业都变成一次成长！</p>
            <div class="input-group">
                <input type="text" id="license-input" placeholder="请输入老师的魔法授权码" maxlength="19">
                <button id="verify-btn">开启魔法门</button>
            </div>
            <p id="auth-msg"></p>
        </div>
    </div>

    <!-- 2. 核心应用界面 -->
    <div id="app-screen" class="screen">
        <header>
            <div class="header-left">
                <button class="global-back-btn" title="返回首页">🔙</button>
                <div>
                    <h2 id="app-header-title">🏫 作业消消乐</h2>
                    <div class="date-display">
                        <span id="current-date">加载中...</span>
                        <span id="current-week-day">...</span>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <button id="reset-week-btn" class="secondary-btn">🔄 开始新的一周</button>
                <button id="fullscreen-btn" class="icon-btn" title="全屏显示">📺</button>
                <button id="settings-btn" class="icon-btn" title="设置/学生管理">⚙️</button>
                <button id="logout-btn" class="icon-btn" title="退出">🚪</button>
            </div>
        </header>

        <main>
            <!-- 左侧：消消乐区域 -->
            <section class="game-zone">
                <div class="game-header">
                    <h3 id="daily-task-title">今日任务: 消灭未完成!</h3>
                    <div class="progress-bar">
                        <div id="daily-progress" style="width: 0%"></div>
                    </div>
                </div>
                <div id="student-grid" class="grid-container">
                    <!-- 学生泡泡 -->
                </div>
            </section>

            <!-- 中间：奖惩区 -->
            <section class="rules-zone">
                <div class="rules-panel">
                    <div class="rule-box reward">
                        <label id="reward-label">🏆 全班作业完成奖励:</label>
                        <textarea id="reward-text" placeholder="例如: 全班奖励冰激凌🍦"></textarea>
                    </div>
                    <div class="rule-box punishment">
                        <label id="punishment-label">⚠️ 未完成惩罚:</label>
                        <textarea id="punishment-text" placeholder="例如: 扣除班级积分"></textarea>
                    </div>
                    <button id="save-rules-btn">💾 保存规则</button>
                </div>
            </section>

            <!-- 右侧：大树 -->
            <section class="visualization-zone">
                <div class="tree-container" id="tree-container">
                    <!-- SVG将由JavaScript动态生成 -->
                </div>
            </section>
        </main>
    </div>

    <!-- 弹窗：设置 -->
    <div id="settings-modal" class="modal hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="settings-modal-title">📋 管理学生名单</h2>
            <div class="tab-container">
                <button class="tab-btn active" data-tab="manual" id="tab-manual-text">手动输入</button>
                <button class="tab-btn" data-tab="csv" id="tab-csv-text">表格导入</button>
            </div>
            <div id="tab-manual" class="tab-content active">
                <textarea id="student-list-input"></textarea>
            </div>
            <div id="tab-csv" class="tab-content">
                <label for="csv-file-input" class="file-upload-btn">📂 选择文件 (CSV/TXT)</label>
                <input type="file" id="csv-file-input" accept=".csv,.txt" style="display: none;">
                <textarea id="csv-input" placeholder="或直接粘贴表格内容(用逗号或换行分隔)"></textarea>
            </div>
            <div class="modal-actions">
                <button id="import-btn" class="primary-btn">导入并重置游戏</button>
                <button id="clear-data-btn" class="danger-btn">🗑️ 清空所有数据</button>
            </div>
            <p class="hint" id="settings-hint">注意：导入新名单会重置本周进度！</p>
        </div>
    </div>

    <!-- 弹窗：确认 -->
    <div id="confirm-modal" class="modal hidden">
        <div class="modal-content confirm-box">
            <h3 id="confirm-title-text">✅ 确认完成?</h3>
            <p id="confirm-student-name">学生姓名</p>
            <div class="modal-actions">
                <button id="confirm-yes" class="primary-btn">是，完成了！</button>
                <button id="confirm-no" class="secondary-btn">取消</button>
            </div>
        </div>
    </div>

    <script src="translations.js"></script>
    <script src="script.js"></script>
</body>
</html>